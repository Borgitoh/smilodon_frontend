<div class="users-container">
  <app-header 
    title="Gestão de Usuários" 
    subtitle="Cadastrar e gerir usuários do sistema">
  </app-header>

  <div class="users-content">
    <!-- Action Bar -->
    <div class="action-bar">
      <div class="search-box">
        <span class="search-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
        </span>
        <input type="text" placeholder="Pesquisar usuários..." class="search-input">
      </div>
      
      <button class="add-user-btn" (click)="toggleAddForm()">
        <span class="btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="16"/>
            <line x1="8" y1="12" x2="16" y2="12"/>
          </svg>
        </span>
        Novo Usuário
      </button>
    </div>

    <!-- Add User Form -->
    <div class="add-form-container" *ngIf="showAddForm">
      <div class="add-form">
        <div class="form-header">
          <h3 class="form-title">Adicionar Novo Usuário</h3>
          <button class="close-btn" (click)="toggleAddForm()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Nome Completo</label>
            <input 
              type="text" 
              class="form-input" 
              [(ngModel)]="newUser.name"
              placeholder="Nome do usuário">
          </div>
          
          <div class="form-group">
            <label class="form-label">Email</label>
            <input 
              type="email" 
              class="form-input" 
              [(ngModel)]="newUser.email"
              placeholder="usuario@smilodon.com">
          </div>
          
          <div class="form-group">
            <label class="form-label">Telefone</label>
            <input 
              type="tel" 
              class="form-input" 
              [(ngModel)]="newUser.phone"
              placeholder="+244 923 456 789">
          </div>
          
          <div class="form-group">
            <label class="form-label">Departamento</label>
            <input 
              type="text" 
              class="form-input" 
              [(ngModel)]="newUser.department"
              placeholder="Departamento">
          </div>
          
          <div class="form-group">
            <label class="form-label">Função</label>
            <select class="form-input" [(ngModel)]="newUser.role">
              <option value="user">Usuário</option>
              <option value="manager">Gerente</option>
              <option value="admin">Administrador</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Status</label>
            <select class="form-input" [(ngModel)]="newUser.status">
              <option value="active">Ativo</option>
              <option value="inactive">Inativo</option>
            </select>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="cancel-btn" (click)="toggleAddForm()">Cancelar</button>
          <button class="save-btn" (click)="addUser()">Guardar Usuário</button>
        </div>
      </div>
    </div>

    <!-- Users Grid -->
    <div class="users-grid">
      <div class="user-card" *ngFor="let user of users$ | async">
        <div class="user-header">
          <div class="user-avatar">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
          </div>
          <div class="user-info">
            <h3 class="user-name">{{ user.name }}</h3>
            <p class="user-email">{{ user.email }}</p>
          </div>
          <div class="user-status">
            <span class="role-badge" [ngClass]="getRoleClass(user.role)">
              {{ getRoleText(user.role) }}
            </span>
            <span class="status-badge" [ngClass]="user.status">
              {{ getStatusText(user.status) }}
            </span>
          </div>
        </div>
        
        <div class="user-details">
          <div class="detail-row">
            <span class="detail-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
              </svg>
            </span>
            <span class="detail-value">{{ user.phone }}</span>
          </div>
          
          <div class="detail-row">
            <span class="detail-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5m-4 0h4"/>
              </svg>
            </span>
            <span class="detail-value">{{ user.department }}</span>
          </div>
          
          <div class="detail-row">
            <span class="detail-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
            </span>
            <span class="detail-value">Último acesso: {{ formatDate(user.lastLogin) }}</span>
          </div>
          
          <div class="detail-row">
            <span class="detail-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
              </svg>
            </span>
            <span class="detail-value">Criado em: {{ formatDate(user.createdAt) }}</span>
          </div>
        </div>
        
        <div class="user-actions">
          <button class="action-btn edit">
            <span class="btn-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
              </svg>
            </span>
            Editar
          </button>
          <button 
            class="action-btn status"
            (click)="updateUserStatus(user.id, user.status === 'active' ? 'inactive' : 'active')">
            <span class="btn-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4"/>
                <circle cx="21" cy="12" r="1"/>
                <circle cx="3" cy="12" r="1"/>
                <circle cx="12" cy="21" r="1"/>
                <circle cx="12" cy="3" r="1"/>
                <circle cx="18.364" cy="18.364" r="1"/>
                <circle cx="5.636" cy="5.636" r="1"/>
                <circle cx="18.364" cy="5.636" r="1"/>
                <circle cx="5.636" cy="18.364" r="1"/>
              </svg>
            </span>
            {{ user.status === 'active' ? 'Desativar' : 'Ativar' }}
          </button>
          <button class="action-btn delete" (click)="deleteUser(user.id)">
            <span class="btn-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"/>
                <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
              </svg>
            </span>
            Excluir
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
